{
    "blocks": "[{\"id\":\"ad831078-2408-4521-b14d-e4f4e39a551f\",\"type\":\"paragraph\",\"object\":{\"label\":\"Goal\",\"body\":\"<p>When handling data in a elasticms JsonMenuNestedEditorField we should be able to parse the structure to get the content for the website search.</p>\"},\"label\":\"Goal\"},{\"id\":\"555ade74-9842-42e4-955b-54f5b84f962d\",\"object\":{\"label\":\"Computed field\",\"body\":\"The idea is to parse the Json menu, at finalization, in an computed field.\\r\\n\\r\\nRegardless the type of container, let assume that I should extract those data fields:\\r\\n\\r\\n - label\\r\\n - body\\r\\n - value\\r\\n - sub-title\\r\\n\\r\\nHere is the value template.\\r\\n\\r\\n```\\r\\n{% set data = {} %}\\r\\n\\r\\n{% for item in _source.blocks|default('{}')|ems_json_menu_nested_decode %}\\r\\n     {% if item.label is defined %}\\r\\n         {% set data = data|merge([item.label]) %}\\r\\n     {% endif %}\\r\\n     {% if item.object.body is defined %}\\r\\n         {% set data = data|merge([item.object.body|striptags]) %}\\r\\n     {% endif %}\\r\\n     {% if item.object.value is defined %}\\r\\n         {% set data = data|merge([item.object.value]) %}\\r\\n     {% endif %}\\r\\n     {% if attribute(item.object, 'sub-title') is defined %}\\r\\n         {% set data = data|merge([attribute(item.object, 'sub-title')]) %}\\r\\n     {% endif %}\\r\\n{% endfor %}\\r\\n\\r\\n{{ data|json_encode|raw }}\\r\\n```\\r\\n\\r\\nTo check what has been extracted define this Display template.\\r\\n\\r\\n```twig\\r\\n{{ data|json_encode }}\\r\\n```\\r\\n\\r\\nAnd finally the mapping to define:\\r\\n\\r\\n```\\r\\n{\\r\\n    \\\"type\\\" : \\\"text\\\",\\r\\n    \\\"copy_to\\\": \\\"live_search\\\"\\r\\n}\\r\\n```\"},\"label\":\"Computed field\",\"type\":\"doc\"}]",
    "description": "When handling data in a elasticms JsonMenuNestedEditorField we should be able to parse the structure to get the content for the website search.",
    "label": "2021-06-08 How to extract data from a nestedJsonMenu",
    "locale": "en",
    "path": "blog/2021-06-08/extract-data-from-json-menu-nested-editor",
    "published_date": "2021-06-08T15:36:46+02:00",
    "search": [
        "Goal",
        "When handling data in a elasticms JsonMenuNestedEditorField we should be able to parse the structure to get the content for the website search.",
        "Computed field",
        "The idea is to parse the Json menu, at finalization, in an computed field.\r\n\r\nRegardless the type of container, let assume that I should extract those data fields:\r\n\r\n - label\r\n - body\r\n - value\r\n - sub-title\r\n\r\nHere is the value template.\r\n\r\n```\r\n{% set data = {} %}\r\n\r\n{% for item in _source.blocks|default('{}')|ems_json_menu_nested_decode %}\r\n     {% if item.label is defined %}\r\n         {% set data = data|merge([item.label]) %}\r\n     {% endif %}\r\n     {% if item.object.body is defined %}\r\n         {% set data = data|merge([item.object.body|striptags]) %}\r\n     {% endif %}\r\n     {% if item.object.value is defined %}\r\n         {% set data = data|merge([item.object.value]) %}\r\n     {% endif %}\r\n     {% if attribute(item.object, 'sub-title') is defined %}\r\n         {% set data = data|merge([attribute(item.object, 'sub-title')]) %}\r\n     {% endif %}\r\n{% endfor %}\r\n\r\n{{ data|json_encode|raw }}\r\n```\r\n\r\nTo check what has been extracted define this Display template.\r\n\r\n```twig\r\n{{ data|json_encode }}\r\n```\r\n\r\nAnd finally the mapping to define:\r\n\r\n```\r\n{\r\n    \"type\" : \"text\",\r\n    \"copy_to\": \"live_search\"\r\n}\r\n```"
    ],
    "template": "blog",
    "title": "How to extract data from a JsonMenuNestedEditorField"
}